import{d as e,u as t,r as n,az as s,p as r,b4 as o,U as a,aO as i,aC as l,c,j as u,i as d,S as f,b as p,J as m,a as h,e as v,t as b,as as g,H as y,h as x,y as w,z as _,P as I,w as k,L as T,aa as M,F as L,D as S,b2 as A}from"./index_3.11.0.22--2602021337_b7dc42e999.js";import{g as D}from"./Priority_3.11.0.22--2602021337_b7dc42e999.js";import{_ as C}from"./MessageForm_3.11.0.22--2602021337_b7dc42e999.js";import{M as F}from"./MessageAuthLevel_3.11.0.22--2602021337_b7dc42e999.js";import{useNavigationStore as P}from"./navigation_3.11.0.22--2602021337_b7dc42e999.js";import{u as j}from"./useMessageDefaultCollectionHandler_3.11.0.22--2602021337_b7dc42e999.js";import{_ as W}from"./ExtendedScrollArea.vue_vue_type_script_setup_true_lang_3.11.0.22--2602021337_b7dc42e999.js";(function(e,t){const n=J,s=e();while(!![])try{const e=-parseInt(n(201))/1*(parseInt(n(208))/2)+-parseInt(n(218))/3*(parseInt(n(227))/4)+-parseInt(n(234))/5*(-parseInt(n(235))/6)+parseInt(n(205))/7+parseInt(n(219))/8*(parseInt(n(236))/9)+-parseInt(n(228))/10+-parseInt(n(181))/11*(-parseInt(n(197))/12);if(e===t)break;else s["push"](s["shift"]())}catch(r){s["push"](s["shift"]())}})(re,184761);const B=function(){let e=!![];return function(t,n){const s=e?function(){const e=J;if(n){const s=n[e(192)](t,arguments);return n=null,s}}:function(){};return e=![],s}}(),E=B(void 0,(function(){const e=J;return E["toString"]()["search"](e(232))[e(202)]()[e(186)](E)[e(229)](e(232))}));E();const U=function(){let e=!![];return function(t,n){const s=e?function(){const e=J;if(n){const s=n[e(192)](t,arguments);return n=null,s}}:function(){};return e=![],s}}(),H=U(void 0,(function(){const e=J;let t;try{const n=Function(e(224)+e(189)+");");t=n()}catch(r){t=window}const n=t[e(233)]=t[e(233)]||{},s=[e(222),"warn",e(226),"error",e(217),"table",e(230)];for(let o=0;o<s[e(211)];o++){const t=U[e(186)]["prototype"][e(185)](U),r=s[o],a=n[r]||t;t["__proto__"]=U["bind"](U),t[e(202)]=a["toString"]["bind"](a),n[r]=t}}));H();function J(e,t){const n=re();return J=function(e,t){e-=181;let s=n[e];return s},J(e,t)}const O={key:0,class:"absolute bottom-0 left-0"},V={class:"message-display"},Y={class:"message-header"},z={class:"header-left"},G={key:0,class:"prio"},N={class:"prio-label"},Q={class:"header-right"},R={class:"message-id"},$={key:0,class:"font-semibold text-fontPassive whitespace-nowrap"},K={key:1,class:"whitespace-nowrap w-min"},X={class:"message-author"},q={class:"message-title"},Z=["title"],ee={key:1,class:"font-semibold text-fontPassive text-lg"},te={class:"message-content"},ne=["title"],se={key:1,class:"font-semibold text-fontPassive text-sm"};function re(){const e=["exception","962391fspUJo","377144WMWFfH","seenWhen","includes","log","calculatedTitle","return (function() ","message","info","4ZxwLLY","3345480YQWOXM","search","trace","STUDENT","(((.+)+)+)+$","console","15DIBTlO","513126ifTYeI","45IuJzzi","primaryAuthor","push","13145MrwWWY","_id","readWhen","doArchive","bind","constructor","hasUserMaskedView","calculatedExtendedTitle",'{}.constructor("return this")( )',"authLevel","priority","apply","value","iHaveReadIt","noAuthorFoundLabel","visibleTo","4836lspgpf","lastContentChange","None","noContent","273QmYptn","toString","setArchive","show","246610scSVrA","Bin","calculatedTitleShort","1238PKTVKT","Archive","doMoveToInbox","length","more","person","previewText","context","title"];re=function(){return e};return re()}const oe=e({__name:"MessagePreview",props:{context:{default:"inbox"},message:{},masked:{type:Boolean,default:![]}},emits:["refetch","open"],setup(e,{emit:_}){const I=J,k=P(),T=r(),M=t(),L=j(),S=e,A=_,W=n(new s((()=>"messagePreview:"+S[I(225)]["id"]),[{identifier:"mPMore",label:M[I(212)],callback:()=>{const e=I;T["push"]({name:"m.detail",params:{mId:S[e(225)]["_id"]}})},visible(){return!![]}},{identifier:"mPArchive",label:M[I(184)],callback:async()=>{const e=I;if(S[e(225)]["me"]===void 0||S[e(225)]["me"]===null)return;L["setArchive"](S[e(225)]["me"]["id"],o[e(209)],(()=>A("refetch")))},visible:()=>{const e=I;return["inbox"][e(221)](S["context"])}},{identifier:"moveToInbox",label:M[I(210)],callback:async()=>{const e=I;if(S["message"]["me"]===void 0||S[e(225)]["me"]===null)return;L["setArchive"](S[e(225)]["me"]["id"],o[e(199)],(()=>T[e(238)]({name:"m.inbox"})))},visible:()=>{const e=I;return["archive","bin"][e(221)](S[e(215)])&&new Date(S["message"]["visibleTo"])>new Date}},{identifier:"mPDelete",label:M["doDelete"],callback:async()=>{const e=I;if(S[e(225)]["me"]===void 0||S[e(225)]["me"]===null)return;L[e(203)](S["message"]["me"]["id"],o[e(206)],(()=>A("refetch")))},visible:()=>{const e=I;return["inbox","archive","drafts"][e(221)](S[e(215)])}}])),B=a((()=>{const e=I;return S[e(225)][e(194)]??![]})),E=a((()=>{const e=I,t=S[e(225)][e(237)]?.[e(213)];return t?i({person:t,showName:!![]}):M[e(195)]})),U=a((()=>{const e=I;if(S[e(225)]["priority"]===void 0)return"";return D(S["message"][e(191)])})),H=a((()=>{const e=I;return S["masked"]&&l()[e(187)]&&(S[e(225)][e(190)]&F[e(231)])===0})),re=a((()=>{const e=I;if(!S[e(225)]["me"]||!S[e(225)][e(198)]||!S[e(225)]["me"][e(183)]&&!S["message"]["me"][e(220)])return![];return new Date(S[e(225)][e(198)])>new Date(S[e(225)]["me"]?.["readWhen"]??S[e(225)]["me"]?.[e(220)])})),oe=a((()=>{const e=I;return S[e(225)]["calculatedExtendedTitleShort"]||S[e(225)][e(188)]||S[e(225)][e(207)]||S["message"][e(223)]||S[e(225)][e(216)]||""}));return(t,n)=>{const s=I;return w(),c("div",{class:f(["message-preview relative",{selected:p(k)["selectedMessageId"]===e[s(225)][s(182)],unread:!B[s(193)]}]),tabindex:"0",onClick:n[0]||(n[0]=u((e=>A("open",S[s(225)][s(182)])),["stop"])),onKeydown:n[1]||(n[1]=d((t=>A("open",e[s(225)]["_id"])),["enter"])),onContextmenu:n[2]||(n[2]=u((e=>{const t=s;W[t(193)]["hide"](),W[t(193)][t(204)](e)}),["prevent","stop"]))},[re["value"]?(w(),c("div",O,[...n[3]||(n[3]=[h("div",{class:"rounded-tr-xl bg-primaryColor w-max h-8 text-rawFontColorWhite box-border px-2 pr-4 flex items-center justify-center"},[h("span",null,"Aktualisiert")],-1)])])):m("",!![]),n[5]||(n[5]=h("div",{class:"left-border"},null,-1)),h("div",V,[h("div",Y,[h("div",z,[U[s(193)]["length"]>0?(w(),c("div",G,[v(C,{class:"mr-1",priority:e[s(225)]["priority"]},null,8,["priority"]),h("span",N,b(U["value"]),1)])):m("",!![])]),h("div",Q,[h("span",R,b(e[s(225)]["_id"]),1),n[4]||(n[4]=h("div",{class:"header-right-separator"},null,-1)),e["message"][s(196)]===void 0?(w(),c("span",$,b(p(M)["noDateGiven"]),1)):(w(),c("span",K,b(p(M)["to"])+" "+b(p(g)["date"]["dateTimeDisplay"](e["message"][s(196)]!==void 0?new Date(e[s(225)][s(196)]):void 0)),1))])]),h("div",X,[h("span",null,b(E[s(193)]),1)]),h("div",q,[oe[s(193)][s(211)]>0?(w(),c("p",{key:0,title:oe[s(193)]},b(oe[s(193)]),9,Z)):(w(),c("p",ee,b(p(M)["noTitle"]),1))]),h("div",te,[e[s(225)][s(214)][s(211)]>0&&!H[s(193)]?(w(),c("p",{key:0,title:e[s(225)][s(214)],class:"message-content-label"},b(e[s(225)]["previewText"]),9,ne)):!H[s(193)]?(w(),c("p",se,b(p(M)[s(200)]),1)):(w(),y(x,{key:2,mode:"seamless",icon:"lock",title:p(M)["projectorProtection"],iconSet:"material",class:"font-bold text-fontPassive"},null,8,["title"]))])])],34)}}});const ae=_(oe,[["__scopeId","data-v-b3ca95ba"]]);function ie(){const e=["1666835pbvRBc","log","onScroll","title","key",'{}.constructor("return this")( )',"canLoadMore","10JBrvCr","prototype","bind","table","constructor","2763513LcFEpy","firstname","general","person","apply","$slots","nothingFoundHere","7XbLueh","$emit","trace","primaryAuthor","exception","945bMmrBI","373760SGjXUf","length","includes","loading","value","substring","toLowerCase","return (function() ","loadingLabel","loginid","calculatedExtendedTitleShort","warn","1275928GDVSNj","filter","lastname","messages","visibleTo","__proto__","date","fetchActiveTags","search","messageFilterPrefix","previewText","568606RQpOFV","3460JUQmqE","(((.+)+)+)+$","dateTimeDisplay","context","2370498fGeatU","console","loadingMore","toString"];ie=function(){return e};return ie()}(function(e,t){const n=he,s=e();while(!![])try{const e=-parseInt(n(253))/1+-parseInt(n(254))/2*(-parseInt(n(286))/3)+-parseInt(n(287))/4+parseInt(n(262))/5+-parseInt(n(258))/6+parseInt(n(281))/7*(parseInt(n(242))/8)+parseInt(n(274))/9*(parseInt(n(269))/10);if(e===t)break;else s["push"](s["shift"]())}catch(r){s["push"](s["shift"]())}})(ie,287736);const le=function(){let e=!![];return function(t,n){const s=e?function(){const e=he;if(n){const s=n[e(278)](t,arguments);return n=null,s}}:function(){};return e=![],s}}(),ce=le(void 0,(function(){const e=he;return ce[e(261)]()["search"](e(255))[e(261)]()["constructor"](ce)[e(250)](e(255))}));ce();const ue=function(){let e=!![];return function(t,n){const s=e?function(){if(n){const e=n["apply"](t,arguments);return n=null,e}}:function(){};return e=![],s}}(),de=ue(void 0,(function(){const e=he;let t;try{const n=Function(e(237)+e(267)+");");t=n()}catch(r){t=window}const n=t[e(259)]=t[e(259)]||{},s=[e(263),e(241),"info","error",e(285),e(272),e(283)];for(let o=0;o<s["length"];o++){const t=ue[e(273)][e(270)][e(271)](ue),r=s[o],a=n[r]||t;t[e(247)]=ue[e(271)](ue),t[e(261)]=a[e(261)][e(271)](a),n[r]=t}}));de();const fe={key:0,class:"w-full h-full"},pe={key:1,class:"h-full flex items-center justify-center"},me={class:"font-medium text-xl text-fontPassive"};function he(e,t){const n=ie();return he=function(e,t){e-=234;let s=n[e];return s},he(e,t)}const ve=e({__name:"MessageInbox",props:{filter:{default:""},messages:{default:null},loading:{type:Boolean,default:![]},loadingLabel:{default:void 0},loadingMore:{type:Boolean,default:void 0},canLoadMore:{type:Boolean},context:{default:"inbox"},masked:{type:Boolean,default:![]},onScroll:{type:Function,default:()=>{}}},emits:["setFilter","open","refetch"],setup(e,{emit:n}){const s=t(),r=e,o=n,i=a((()=>{const e=he;return(r[e(245)]??[])[e(243)]((t=>{const n=e,s=r[n(243)]["trim"]()["toLowerCase"]();if(s["startsWith"](I[n(276)][n(251)])){let e=s[n(235)](1,s[n(288)]-1);const t=I["message"]["messageFilters"]["filter"]((t=>{const s=n;return t[s(266)][s(236)]()["startsWith"](e)}));t["length"]===1&&(e=t[0][n(266)],o("setFilter",I[n(276)][n(251)]+e))}if(t[n(265)]?.["toLowerCase"]()[n(289)](s))return!![];if(t[n(240)]?.["toLowerCase"]()[n(289)](s))return!![];if(t["body"]?.[n(236)]()["includes"](s))return!![];if(t[n(252)]?.["toLowerCase"]()[n(289)](s))return!![];if((t["id"]??"")[n(261)]()[n(289)](s))return!![];if(t[n(246)]!==void 0&&t["visibleTo"]!==null)if(g[n(248)][n(256)](new Date(t[n(246)]))[n(236)]()[n(289)](s))return!![];if(D(t["priority"])[n(236)]()["includes"](s))return!![];if(t["primaryAuthor"]?.[n(277)]?.[n(244)]?.[n(236)]()[n(289)](s))return!![];if(t["primaryAuthor"]?.[n(277)]?.[n(275)]?.[n(236)]()[n(289)](s))return!![];if(t[n(284)]?.[n(277)]?.[n(239)]?.[n(236)]()[n(289)](s))return!![];return![]}))}));function l(){const e=he;A()[e(249)](),o("refetch")}return(t,n)=>{const o=he;return w(),c("div",{class:f(["w-full h-full relative",{"opacity-50":r[o(290)]&&i[o(234)][o(288)]>0}])},[r[o(290)]===![]&&r[o(245)]!==null?(w(),c("div",fe,[i["value"]["length"]>0?(w(),y(W,{key:0,class:"w-full h-full overflow-x-hidden flex-1 min-h-0",onScroll:e[o(264)],canLoadMore:r[o(268)]},{default:k((()=>[h("div",null,[(w(!![]),c(L,null,S(i[o(234)],(e=>{const s=o;return w(),y(ae,{key:e["id"],message:e,context:r[s(257)],masked:r["masked"],onOpen:n[0]||(n[0]=e=>t[s(282)]("open",e)),onRefetch:n[1]||(n[1]=e=>l())},null,8,["message","context","masked"])})),128)),r[o(260)]?(w(),y(T,{key:0,mod:"center",type:"small",label:p(s)["loadingMore"]},null,8,["label"])):m("",!![]),M(t[o(279)],"afterList")])])),_:3},8,["onScroll","canLoadMore"])):(w(),c("div",pe,[h("span",me,b(p(s)[o(280)]),1)]))])):m("",!![]),e[o(290)]===!![]?(w(),y(T,{key:1,type:"small",label:r[o(238)]??p(s)[o(290)]},null,8,["label"])):m("",!![])],2)}}});export{ve as _};
